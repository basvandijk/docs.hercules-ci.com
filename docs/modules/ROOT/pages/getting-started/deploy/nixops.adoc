= Deploy with NixOps

1.
include::partial$autogenerate/Bootstrap.adoc[]

2.
include::partial$autogenerate/Target.adoc[]

3.
Get a cluster join token.

--
- In the https://hercules-ci.com/dashboard[dashboard], find the account for which you would like to deploy the agent,
- Click the "Agents" button and the button in "Generate token" tab. This produces a private token that should be protected like a password.
- Copy the token into a plain text file `cluster-join-token.key` in the same directory. Protect this file like a password.
--

4.
Write a file `binary-caches.json` in the same directory as `hercules-ci-agents.nix`.

include::partial$autogenerate/BinaryCachesJson.adoc[]

5.
include::partial$autogenerate/Deploy.adoc[]

== Troubleshooting

To inspect the agent's local log, run `nixops ssh agent journalctl -u hercules-ci-agent -n 100` to see the last 100 lines.
